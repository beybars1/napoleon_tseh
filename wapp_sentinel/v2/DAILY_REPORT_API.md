# Daily Order Report API

API endpoints –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤ –æ –∑–∞–∫–∞–∑–∞—Ö –≤ WhatsApp.

## Endpoints

### 1. Preview Daily Report (–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—á–µ—Ç–∞)

**GET** `/orders/daily-report/{date}`

–ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—á–µ—Ç–∞ –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∞—Ç—É –±–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ WhatsApp.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã URL:**
- `date` - –¥–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM-DD` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `2025-11-03`)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl http://localhost:8000/orders/daily-report/2025-11-03
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "date": "2025-11-03",
  "orders_count": 5,
  "report": "üìã –ó–ê–ö–ê–ó–´ –ù–ê 03.11.2025\n..."
}
```

---

### 2. Preview Daily Report (POST) (–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —á–µ—Ä–µ–∑ POST)

**POST** `/orders/preview-daily-report`

–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—á–µ—Ç–∞ —á–µ—Ä–µ–∑ POST –∑–∞–ø—Ä–æ—Å.

**Body:**
```json
{
  "date": "2025-11-03"
}
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl -X POST http://localhost:8000/orders/preview-daily-report \
  -H "Content-Type: application/json" \
  -d '{"date": "2025-11-03"}'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "success",
  "date": "2025-11-03",
  "orders_count": 5,
  "report_preview": "üìã –ó–ê–ö–ê–ó–´ –ù–ê 03.11.2025\n..."
}
```

---

### 3. Send Daily Report (–û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–∞ –≤ WhatsApp)

**POST** `/orders/send-daily-report`

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π WhatsApp —á–∞—Ç.

**Body:**
```json
{
  "date": "2025-11-03",
  "chat_id": "120363111111111@g.us"
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `date` - –¥–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM-DD`
- `chat_id` - ID WhatsApp —á–∞—Ç–∞ (–¥–ª—è –≥—Ä—É–ø–ø –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ `@g.us`)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl -X POST http://localhost:8000/orders/send-daily-report \
  -H "Content-Type: application/json" \
  -d '{
    "date": "2025-11-03",
    "chat_id": "120363111111111@g.us"
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "success",
  "date": "2025-11-03",
  "chat_id": "120363111111111@g.us",
  "orders_count": 5,
  "greenapi_response": {
    "idMessage": "3EB0...",
    "status": "sent"
  }
}
```

---

## –§–æ—Ä–º–∞—Ç –æ—Ç—á–µ—Ç–∞

–û—Ç—á–µ—Ç –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞:

- üïê –í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏
- üí≥ –°—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã (–æ–ø–ª–∞—á–µ–Ω–æ/–Ω–µ –æ–ø–ª–∞—á–µ–Ω–æ)
- üì± –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ (–æ—Å–Ω–æ–≤–Ω–æ–π –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π)
- üë§ –ö—Ç–æ –ø—Ä–∏–Ω—è–ª –∑–∞–∫–∞–∑
- üì¶ –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
- üìÖ –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø—Ä–∏–Ω—è—Ç–∏—è –∑–∞–∫–∞–∑–∞

### –ü—Ä–∏–º–µ—Ä –æ—Ç—á–µ—Ç–∞:

```
üìã –ó–ê–ö–ê–ó–´ –ù–ê 03.11.2025
–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤: 2

1Ô∏è‚É£ –ó–ê–ö–ê–ó #15
üïê –í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏: 14:00
üí≥ ‚úÖ –û–ø–ª–∞—á–µ–Ω–æ
üì± –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–∞–∫—Ç: +77001234567
üë§ –ü—Ä–∏–Ω—è–ª: –ò–≤–∞–Ω
üì¶ –¢–æ–≤–∞—Ä—ã:
   ‚Ä¢ –¢–æ—Ä—Ç "–ù–∞–ø–æ–ª–µ–æ–Ω" - 1 –∫–≥
   ‚Ä¢ –ö–∞–ø–∫–µ–π–∫–∏ - 6 —à—Ç
üìÖ –ü—Ä–∏–Ω—è—Ç: 02.11.2025 18:30

2Ô∏è‚É£ –ó–ê–ö–ê–ó #16
üïê –í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏: 16:30
üí≥ ‚ùå –ù–µ –æ–ø–ª–∞—á–µ–Ω–æ
üì± –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–∞–∫—Ç: +77009876543
üë§ –ü—Ä–∏–Ω—è–ª: –ú–∞—Ä–∏—è
üì¶ –¢–æ–≤–∞—Ä—ã:
   ‚Ä¢ –¢–æ—Ä—Ç "–ü—Ä–∞–≥–∞" - 2 –∫–≥
üìÖ –ü—Ä–∏–Ω—è—Ç: 03.11.2025 09:15

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:
   –í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤: 2
   –û–ø–ª–∞—á–µ–Ω–æ: 1
   –ù–µ –æ–ø–ª–∞—á–µ–Ω–æ: 1
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—á–µ—Ç –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π

```bash
# –°–Ω–∞—á–∞–ª–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
curl http://localhost:8000/orders/daily-report/2025-11-03

# –ï—Å–ª–∏ –≤—Å—ë –æ–∫, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
curl -X POST http://localhost:8000/orders/send-daily-report \
  -H "Content-Type: application/json" \
  -d '{
    "date": "2025-11-03",
    "chat_id": "120363111111111@g.us"
  }'
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç—á–µ—Ç –Ω–∞ —Å–µ–≥–æ–¥–Ω—è

```bash
TODAY=$(date +%Y-%m-%d)
curl -X POST http://localhost:8000/orders/send-daily-report \
  -H "Content-Type: application/json" \
  -d "{
    \"date\": \"$TODAY\",
    \"chat_id\": \"120363111111111@g.us\"
  }"
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç—á–µ—Ç –Ω–∞ –∑–∞–≤—Ç—Ä–∞

```bash
TOMORROW=$(date -d tomorrow +%Y-%m-%d)
curl -X POST http://localhost:8000/orders/send-daily-report \
  -H "Content-Type: application/json" \
  -d "{
    \"date\": \"$TOMORROW\",
    \"chat_id\": \"120363111111111@g.us\"
  }"
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env` —Ñ–∞–π–ª–µ —É–∫–∞–∑–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ credentials –¥–ª—è GreenAPI:

```env
GREENAPI_INSTANCE=your_instance_id
GREENAPI_TOKEN=your_token
GREEN_API_BASE_URL=https://api.green-api.com
```

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–í —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ:
- ‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (APScheduler)
- üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel —Ñ–æ—Ä–º–∞—Ç
- üìÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF –æ—Ç—á–µ—Ç–æ–≤
- üîî WhatsApp –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ—Ç—á–µ—Ç–æ–≤
